"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return _default}});var _os=_interop_require_default(require("os")),_next=_interop_require_default(require("next")),_url=require("url");function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}var dev="production"!==process.env.NODE_ENV,app=(0,_next.default)({dev:dev,customServer:!0}),handle=app.getRequestHandler(),_default=function(){"use strict";var e;function t(e){var r;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),r=void 0,"app"in this?Object.defineProperty(this,"app",{value:r,enumerable:!0,configurable:!0,writable:!0}):this.app=r,this.app=e}return _defineProperties(t.prototype,[{key:"init",value:function(){var e=this;app.prepare().then(function(){e.app.get("/api",function(e,t){var r=process.memoryUsage(),a=function(e){return"".concat(Math.round(e/1024/1024*100)/100," MB")},n={totalMem:a(_os.default.totalmem()),freeMem:a(_os.default.freemem()),usedMem:a(_os.default.totalmem()-_os.default.freemem()),cpus:_os.default.cpus()};t.code(200).header("Content-Type","application/json; charset=utf-8").send({status:"ok",currentProcess:{rss:a(r.rss),heapTotal:a(r.heapTotal),heapUsed:a(r.heapUsed),external:a(r.external),arrayBuffers:r.arrayBuffers},osPerfs:n})}),e.app.get("/api/ping",function(e,t){t.status(200).header("Content-Type","application/json; charset=utf-8").send({status:"ok"})}),e.app.all("*",function(e,t){var r=(0,_url.parse)(e.url,!0);handle(e.raw,t.raw,r)}),e.app.listen({host:"0.0.0.0",port:Number(process.env.PORT||3e3)},function(e,t){e&&(console.error(e),process.exit(1)),console.log("Listening on port ".concat(t))})})}}]),e&&_defineProperties(t,e),t}();